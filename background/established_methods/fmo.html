<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fragment Molecular Orbital Method &mdash; GhostFragment 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=d45e8c67"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Generalized Energy Based Fragmentation (GEBF)" href="gebf.html" />
    <link rel="prev" title="Fragment Energy Assembler (FEA)" href="fea.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            GhostFragment
          </a>
              <div class="version">
                0.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Theoretical Background</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../fragment_based_methods.html">Fragment Based Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbe/index.html">The Many-Body Expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bsse/index.html">Basis Set Superposition Error</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Established Fragment Based Methods</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="overview.html">Overview of Established Fragment Based Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="timeline.html">Timeline of Fragmentation Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="dclc.html">Divide and Conquer Local Correlation (DCLC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="ecmfcc.html">Energy-Corrected MFCC</a></li>
<li class="toctree-l3"><a class="reference internal" href="eembe.html">Electorstatically-Embedded Many-Body Expansion (EE-MB)</a></li>
<li class="toctree-l3"><a class="reference internal" href="efamfcc.html">Electrostatic Field Adapted MFCC (EFA-MFCC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="fea.html">Fragment Energy Assembler (FEA)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Fragment Molecular Orbital Method</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#origins">Origins</a></li>
<li class="toctree-l4"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-fmo-development">Other FMO Development</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="gebf.html">Generalized Energy Based Fragmentation (GEBF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="kem.html">Kernel Energy Method (KEM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mta.html">Molecular Tailoring Approach (MTA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mfcc.html">Molecular Fractionation with Conjugate Caps (MFCC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="smf.html">Systematic Molecular Fragmentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../algorithms/index.html">Algorithms for Fragment-Based Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frag_v_nmer.html">Difference between fragments and n-mers?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../terminology.html">Terminology Used Throughout GhostFragment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bibliography/index.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../module_api/index.html">Modules API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rmrresearch.github.io/GhostFragment/ghostfragment_cxx_api/index.html">C++ API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GhostFragment</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Theoretical Background</a></li>
          <li class="breadcrumb-item"><a href="index.html">Established Fragment Based Methods</a></li>
      <li class="breadcrumb-item active">Fragment Molecular Orbital Method</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/rmrresearch/ghostfragment/edit/master/docs/source/background/established_methods/fmo.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="fragment-molecular-orbital-method">
<h1>Fragment Molecular Orbital Method<a class="headerlink" href="#fragment-molecular-orbital-method" title="Link to this heading"></a></h1>
<p>The fragment molecular orbital (FMO) method is arguably one of the most
established methods in the field of fragment-based methods. The main purpose of
this page is to describe the FMO method, and how the method has developed.</p>
<section id="origins">
<h2>Origins<a class="headerlink" href="#origins" title="Link to this heading"></a></h2>
<section id="pimo">
<h3>PIMO<a class="headerlink" href="#pimo" title="Link to this heading"></a></h3>
<p>The FMO method arguably got its start as the pair interaction molecular orbital
(PIMO) method <span id="id1">Kitaura <em>et al.</em><sup><a class="reference internal" href="../../bibliography/index.html#id45" title="Kazuo Kitaura, Takuya Sawai, Toshio Asada, Tatsuya Nakano, and Masami Uebayasi. Pair interaction molecular orbital method: an approximate computational method for molecular interactions. Chemical Physics Letters, 312(2-4):319–324, 1999.">42</a></sup></span>. In the original paper, for a system split
into <span class="math notranslate nohighlight">\(N\)</span> disjoint fragments, the Hamiltonian for the <span class="math notranslate nohighlight">\(I\)</span>-th fragment
is written as:</p>
<div class="math notranslate nohighlight">
\[\widehat{H}_I = \widehat{H}_I^0 + \sum_{J=1; J\neq I}^N\widehat{V}^I_{J}\]</div>
<p>where <span class="math notranslate nohighlight">\(\widehat{H}_I^0\)</span> is the Hamiltonian of the <span class="math notranslate nohighlight">\(I\)</span>-th fragment
and <span class="math notranslate nohighlight">\(\widehat{V}^I_{J}\)</span> is the interaction of <span class="math notranslate nohighlight">\(I\)</span> with <span class="math notranslate nohighlight">\(J\)</span>.
<span class="math notranslate nohighlight">\(\widehat{V}_{IJ}\)</span> is given by <a class="reference internal" href="../algorithms/embed_methods/density.html#density-embedding"><span class="std std-ref">Density Embedding</span></a>. The PIMO method
considers up to two-body terms, with the Hamiltonian of dimer <span class="math notranslate nohighlight">\(IJ\)</span> given
by:</p>
<div class="math notranslate nohighlight">
\[\widehat{H}_{IJ} = \widehat{H}_{IJ}^0 +
                   \sum_{K=1; K\neq J\neq I}^N\widehat{V}^{IJ}_{K}\]</div>
<p>Analogous to the monomer Hamiltonians, <span class="math notranslate nohighlight">\(\widehat{H}_{IJ}^0\)</span> is the
Hamiltonian of the <span class="math notranslate nohighlight">\(IJ\)</span>-th dimer and <span class="math notranslate nohighlight">\(\widehat{V}^{IJ}_{K}\)</span> is the
interaction of dimer <span class="math notranslate nohighlight">\(IJ\)</span> with fragment <span class="math notranslate nohighlight">\(K\)</span>. Fragment densities are
converged at the one-body level and used as is in two-body terms.</p>
<p>Initial applications of PIMO looked at interaction energies of water trimers and
tetramers. At the HF/6-31G** level of theory PIMO differed from supersystem
interactions by about 0.1 kcal/mol.</p>
</section>
<section id="fmo99">
<h3>FMO99<a class="headerlink" href="#fmo99" title="Link to this heading"></a></h3>
<p>That same year, FMO proper was introduced <span id="id2">Kitaura <em>et al.</em><sup><a class="reference internal" href="../../bibliography/index.html#id44" title="Kazuo Kitaura, Eiji Ikeo, Toshio Asada, Tatsuya Nakano, and Masami Uebayasi. Fragment molecular orbital method: an approximate computational method for large molecules. Chemical Physics Letters, 313(3-4):701–706, 1999.">41</a></sup></span>. Physically the
equations of FMO are the same as PIMO. The difference between FMO and PIMO is
conceptual and has to do with the fragment orbitals. In PIMO each fragment was a
closed-shell molecule, and the intial guess orbitals are simply obtained by
running the isolated closed-shell molecule. In FMO, the initial orbitals for
fragment <span class="math notranslate nohighlight">\(I\)</span> are generated by:</p>
<ul class="simple">
<li><p>creating a reference system for fragment <span class="math notranslate nohighlight">\(I\)</span>,</p></li>
<li><p>localizing the orbitals of the reference system to the atoms in <span class="math notranslate nohighlight">\(I\)</span>,</p></li>
<li><p>discarding contributions to the orbitals from atoms outside of <span class="math notranslate nohighlight">\(I\)</span>, and then</p></li>
<li><p>renormalizing the orbitals.</p></li>
</ul>
<p>How to fragment the system was briefly considered for ethanol; initial results
showed the final accuarcy was quite sensitive to fragment choice (differing by
up to 7 kcal/mol). The only suggestion was to not make the fragments too small.
Additional calculations on propane, propanol, and methylacetamide further served
as a proof-of-principles for FMO. All calculations were done using SCF/STO-3G.</p>
</section>
<section id="fmo00">
<h3>FMO00<a class="headerlink" href="#fmo00" title="Link to this heading"></a></h3>
<p>Shortly after introducing the original FMO procedure, the capping procedure was
overhauled. The new FMO00 capping procedure no longer requires reference systems
to obtain the initial densities. Instead, the electrons in a bond are assigned
to one of the two atoms. Assuming the two bonded fragments are <span class="math notranslate nohighlight">\(I\)</span> and <span class="math notranslate nohighlight">\(J\)</span>, we
further assume <span class="math notranslate nohighlight">\(I\)</span> gets the electrons. In this case, the equations for <span class="math notranslate nohighlight">\(J\)</span> are
solved normally, whereas the equations for <span class="math notranslate nohighlight">\(I\)</span> are solved with a basis set
that includes part of the valence space of <span class="math notranslate nohighlight">\(J\)</span> (specifically the part from the
bonded atom).</p>
<p>Also notable about this FMO incarnation is that it introduced a screening
method. The FMO00 screening procedure relies on distance cutoffs (based on the
shortest inter-atomic distance) to approximate the two-body interactions in some
dimers. The dimer interactions for distant dimers are not neglected, rather they
are approximated using the one-body densities.</p>
<p>All initial calculations used the SCF/STO-3G model. Application of FMO00 to
propane showed that the error in the total energy (relative to the traditional
calculation) decreased relative to FMO99. This study also applied FMO00 was to
peptides. For the peptides the fragment size was again considered. Results were
markedly better when there are two amino acids in a fragment vs. one (maximum
error in the total energy decreased from 8.9 kcal/mol to around 1 kcal/mol).
Relative energies of the peptides had a maximum error of about 1.5 kcal/mol.</p>
</section>
<section id="fmo02">
<h3>FMO02<a class="headerlink" href="#fmo02" title="Link to this heading"></a></h3>
<p>The next incarnation of FMO introduced approimations to the embedding method. In
traditional density embedding, monomer <span class="math notranslate nohighlight">\(I\)</span> interacts with the density of each
monomer <span class="math notranslate nohighlight">\(J\)</span>. This amounts to a term analogous to the Coulomb build in SCF, but
with the density of <span class="math notranslate nohighlight">\(J\)</span>. Like it’s SCF brethern, the computational complexity of
this terms scale as <span class="math notranslate nohighlight">\(\mathcal{O}(N^4)\)</span>. To reduce the cost of the
embedding, the <a class="reference internal" href="../algorithms/embed_methods/density.html#fmo02-embedding"><span class="std std-ref">FMO02 Embedding</span></a> method <span id="id3">Nakano <em>et al.</em><sup><a class="reference internal" href="../../bibliography/index.html#id48" title="Tatsuya Nakano, Tsuguchika Kaminuma, Toshiyuki Sato, Kaori Fukuzawa, Yutaka Akiyama, Masami Uebayasi, and Kazuo Kitaura. Fragment molecular orbital method: use of approximate electrostatic potential. Chemical Physics Letters, 351(5-6):475–480, 2002.">70</a></sup></span>: was
introduced. As a proof-of-concept, the study considered applications to proteins
using the HF/STO-3G method. Errors, were similar to the FMO00 method, but
results were obtained significantly faster.</p>
</section>
<section id="fmo04-three-body-fmo">
<h3>FMO04 (Three-Body FMO)<a class="headerlink" href="#fmo04-three-body-fmo" title="Link to this heading"></a></h3>
<p>The next development in FMO was an extension capable of handeling three-body
terms <span id="id4">Fedorov and Kitaura<sup><a class="reference internal" href="../../bibliography/index.html#id54" title="Dmitri G. Fedorov and Kazuo Kitaura. The importance of three-body terms in the fragment molecular orbital method. The Journal of Chemical Physics, 120(15):6832–6840, 2004.">17</a></sup></span>. This required introducing a screening method for
three body terms, <em>i.e.</em>, <a class="reference internal" href="../algorithms/screening_methods/distance.html#fmo04-screening"><span class="std std-ref">FMO04 Screening</span></a>, and also introduced a new
capping method, <a class="reference internal" href="../algorithms/cap_methods/fmo.html#fmo04-capping"><span class="std std-ref">FMO04 Capping</span></a>, which is essentially a combination of the
<a class="reference internal" href="../algorithms/cap_methods/fmo.html#fmo99-capping"><span class="std std-ref">FMO99 Capping</span></a> and <a class="reference internal" href="../algorithms/cap_methods/fmo.html#fmo00-capping"><span class="std std-ref">FMO00 Capping</span></a> methods. Three-body results
focused on water clusters and peptides with the SCF method and the STO-3G,
3-21G, 6-31G*, and 6-31++G** basis sets. Notably this study was one of the
first to show that FMO performs best with small basis sets, postulating that
this is because of the lack of exchange and intramolecular basis set
superposition error.</p>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Fragments</p></th>
<th class="head"><p>Embedding</p></th>
<th class="head"><p>Caps</p></th>
<th class="head"><p>Screening</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PIMO</p></td>
<td><p>Cluster</p></td>
<td><p>One-body density</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p>FMO99</p></td>
<td><p>N/A</p></td>
<td><p>One-body density</p></td>
<td><p>FMO99</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p>FMO00</p></td>
<td><p>N/A</p></td>
<td><p>One-body density</p></td>
<td><p>FMO00</p></td>
<td><p>FMO00</p></td>
</tr>
<tr class="row-odd"><td><p>FMO02</p></td>
<td><p>N/A</p></td>
<td><p>FMO02</p></td>
<td><p>FMO00</p></td>
<td><p>FMO00</p></td>
</tr>
<tr class="row-even"><td><p>FMO04</p></td>
<td><p>N/A</p></td>
<td><p>FMO02</p></td>
<td><p>FMO04</p></td>
<td><p>FMO04</p></td>
</tr>
</tbody>
</table>
</section>
<section id="other-fmo-development">
<h2>Other FMO Development<a class="headerlink" href="#other-fmo-development" title="Link to this heading"></a></h2>
<p>Initial, approximate gradients for the FMO00 method were published in 2001
<span id="id5">Kitaura <em>et al.</em><sup><a class="reference internal" href="../../bibliography/index.html#id47" title="Kazuo Kitaura, Sin-Ichirou Sugiki, Tatsuya Nakano, Yuto Komeiji, and Masami Uebayasi. Fragment molecular orbital method: analytical energy gradients. Chemical Physics Letters, 336(1-2):163–170, 2001.">43</a></sup></span>. This formulation neglected the coupled-perturbed
Hartree-Fock contribution to the gradient, which is necessary because the
densities are not obtained variationally.</p>
<p><span id="id6">Inadomi <em>et al.</em><sup><a class="reference internal" href="../../bibliography/index.html#id49" title="Yuichi Inadomi, Tatsuya Nakano, Kazuo Kitaura, and Umpei Nagashima. Definition of molecular orbitals in fragment molecular orbital method. Chemical Physics Letters, 364(1-2):139–143, 2002.">35</a></sup></span> detailed a mechanism for retrieving orbital energies and
densities from FMO.</p>
<p><span id="id7">Sekino <em>et al.</em><sup><a class="reference internal" href="../../bibliography/index.html#id50" title="Hideo Sekino, Yasuo Sengoku, Shinichiro Sugiki, and Noriyuki Kurita. Molecular orbital analysis based on fragment molecular orbital scheme. Chemical Physics Letters, 378(5-6):589–597, 2003.">81</a></sup></span> used FMO to approximate a DFT calculation, PW91/STO-3G.
Also considered were the HOMO/LUMO energies, dipole moment, and quadrupole
moment of the systems. Systems considered were water-ammonia clusters and DNA.
Errors in energies were on the order of a millihartree, multipole moments
matched to within a few tenths (units were not specified). A follow up paper
<span id="id8">Sugiki <em>et al.</em><sup><a class="reference internal" href="../../bibliography/index.html#id51" title="Sin-ichirou Sugiki, Noriyuki Kurita, Yasuo Sengoku, and Hideo Sekino. Fragment molecular orbital method with density functional theory and DIIS convergence acceleration. Chemical Physics Letters, 382(5-6):611–617, 2003.">83</a></sup></span> used DIIS to accelerate the convergence of the iterative
charge procedure.</p>
<p><span id="id9">Komeiji <em>et al.</em><sup><a class="reference internal" href="../../bibliography/index.html#id52" title="Yuto Komeiji, Tatsuya Nakano, Kaori Fukuzawa, Yutaka Ueno, Yuichi Inadomi, Tadashi Nemoto, Masami Uebayasi, Dmitri G. Fedorov, and Kazuo Kitaura. Fragment molecular orbital method: application to molecular dynamics simulation, `ab initio FMO-MD'. Chemical Physics Letters, 372(3-4):342–347, 2003.">44</a></sup></span> used FMO to perform a molecular dynamics simulation of a
peptide at the HF/STO-3G level of theory.</p>
<p><span id="id10">Fedorov <em>et al.</em><sup><a class="reference internal" href="../../bibliography/index.html#id55" title="Dmitri G. Fedorov, Ryan M. Olson, Kazuo Kitaura, Mark S. Gordon, and Shiro Koseki. A new hierarchical parallelization scheme: generalized distributed data interface (GDDI), and an application to the fragment molecular orbital method (FMO). Journal of Computational Chemistry, 25(6):872–880, 2004.">18</a></sup></span> discussions about distributed computing of FMO with
GAMESS. Presensts some SCF/6-31G* and SCF/STO-3G calculations of large water
clusters.</p>
<p><span id="id11">Mochizuki <em>et al.</em><sup><a class="reference internal" href="../../bibliography/index.html#id53" title="Yuji Mochizuki, Shigeru Koikegami, Tatsuya Nakano, Shinji Amari, and Kazuo Kitaura. Large scale MP2 calculations with fragment molecular orbital scheme. Chemical Physics Letters, 396(4-6):473–479, 2004.">68</a></sup></span> used the SCF orbitals from an FMO calculation to do MP2.
Also considered in this study were MP2 densities and partially renormalized MP2.
Calculations used the 6-31G basis set and focused on a large water cluster and
several proteins.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fea.html" class="btn btn-neutral float-left" title="Fragment Energy Assembler (FEA)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gebf.html" class="btn btn-neutral float-right" title="Generalized Energy Based Fragmentation (GEBF)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Ryan M Richard.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
#################################
Fragment Molecular Orbital Method
#################################

The fragment molecular orbital (FMO) method is arguably one of the most 
established methods in the field of fragment-based methods.

*******
Origins
*******

.. |I| replace:: :math:`I`
.. |J| replace:: :math:`J`
.. |IJ| replace:: :math:`IJ`

PIMO
====

The FMO method arguably got its start as the pair interaction molecular orbital
(PIMO) method :cite:t:`Kitaura1999a`. In the original paper, for a system split 
into :math:`N` disjoint fragments, the Hamiltonian for the |I|-th fragment 
is written as:

.. math::
   \widehat{H}_I = \widehat{H}_I^0 + \sum_{J=1; J\neq I}^N\widehat{V}^I_{J}

where :math:`\widehat{H}_I^0` is the Hamiltonian of the |I|-th fragment 
and :math:`\widehat{V}^I_{J}` is the interaction of |I| with :math:`J`. 
:math:`\widehat{V}_{IJ}` is given by :ref:`Density Embedding`. The PIMO method
considers up to two-body terms, with the Hamiltonian of dimer |IJ| given
by:

.. math::
   \widehat{H}_{IJ} = \widehat{H}_{IJ}^0 + 
                      \sum_{K=1; K\neq J\neq I}^N\widehat{V}^{IJ}_{K}

Analogous to the monomer Hamiltonians, :math:`\widehat{H}_{IJ}^0` is the 
Hamiltonian of the |IJ|-th dimer and :math:`\widehat{V}^{IJ}_{K}` is the 
interaction of dimer |IJ| with fragment :math:`K`. Fragment densities are
converged at the one-body level and used as is in two-body terms.

Initial applications of PIMO looked at interaction energies of water trimers and 
tetramers. At the HF/6-31G** level of theory PIMO differed from supersystem
interactions by about 0.1 kcal/mol.

FMO99
=====

That same year, FMO proper was introduced :cite:t:`Kitaura1999`. Physically the
equations of FMO are the same as PIMO. The difference between FMO and PIMO is
conceptual and has to do with the fragment orbitals. In PIMO each fragment was a
closed-shell molecule, and the intial guess orbitals are simply obtained by
running the isolated closed-shell molecule. In FMO, the initial orbitals for
fragment |I| are generated by:

- creating a reference system for fragment |I|,
- localizing the orbitals of the reference system to the atoms in |I|,
- discarding contributions to the orbitals from atoms outside of |I|, and then
- renormalizing the orbitals.

How to fragment the system was briefly considered for ethanol; initial results
showed the final accuarcy was quite sensitive to fragment choice (differing by
up to 7 kcal/mol). The only suggestion was to not make the fragments too small.
Additional calculations on propane, propanol, and methylacetamide further served
as a proof-of-principles for FMO. All calculations were done using SCF/STO-3G.

FMO00
=====

Shortly after introducing the original FMO procedure, the capping procedure was
overhauled. The new FMO00 capping procedure no longer requires reference systems
to obtain the initial densities. Instead, the electrons in a bond are assigned
to one of the two atoms. Assuming the two bonded fragments are |I| and |J|, we
further assume |I| gets the electrons. In this case, the equations for |J| are 
solved normally, whereas the equations for |I| are solved with a basis set
that includes part of the valence space of |J| (specifically the part from the
bonded atom).

Also notable about this FMO incarnation is that it introduced a screening 
method. The FMO00 screening procedure relies on distance cutoffs (based on the
shortest inter-atomic distance) to approximate the two-body interactions in some
dimers. The dimer interactions for distant dimers are not neglected, rather they
are approximated using the one-body densities.

All initial calculations used the SCF/STO-3G model. Application of FMO00 to 
propane showed that the error in the total energy (relative to the traditional
calculation) decreased relative to FMO99. This study also applied FMO00 was to 
peptides. For the peptides the fragment size was again considered. Results were 
markedly better when there are two amino acids in a fragment vs. one (maximum 
error in the total energy decreased from 8.9 kcal/mol to around 1 kcal/mol). 
Relative energies of the peptides had a maximum error of about 1.5 kcal/mol. 

FMO02
=====

The next incarnation of FMO introduced approimations to the embedding method. In
traditional density embedding, monomer |I| interacts with the density of each
monomer |J|. This amounts to a term analogous to the Coulomb build in SCF, but 
with the density of |J|. Like it's SCF brethern, the computational complexity of 
this terms scale as :math:`\mathcal{O}(N^4)`. To reduce the cost of the 
embedding, the :ref:`FMO02 embedding` method :cite:t:`Nakano2002`: was 
introduced. As a proof-of-concept, the study considered applications to proteins
using the HF/STO-3G method. Errors, were similar to the FMO00 method, but 
results were obtained significantly faster.



*******
Summary
*******


+-------+-----------+-------------------+-------+-----------+
| Name  | Fragments | Embedding         | Caps  | Screening |
+=======+===========+===================+=======+===========+
| PIMO  | Cluster   | One-body density  | N/A   | N/A       |
+-------+-----------+-------------------+-------+-----------+
| FMO99 | N/A       | One-body density  | FMO99 | N/A       |
+-------+-----------+-------------------+-------+-----------+
| FMO00 | N/A       | One-body density  | FMO00 | FMO00     |
+-------+-----------+-------------------+-------+-----------+
| FMO02 | N/A       | FMO02             | FMO00 | FMO00     |
+-------+-----------+-------------------+-------+-----------+

*********************
Other FMO Development
*********************

Initial, approximate gradients for the FMO00 method were published in 2001 
:cite:t:`Kitaura_2001`. This formulation neglected the coupled-perturbed 
Hartree-Fock contribution to the gradient, which is necessary because the 
densities are not obtained variationally.
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GMBE Weights &mdash; GhostFragment 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=d45e8c67"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Heavy Atom Partition" href="Heavy_Atom_Partition.html" />
    <link rel="prev" title="FragmentedChemicalSystem Driver" href="FragmentedChemicalSystem_Driver.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GhostFragment
          </a>
              <div class="version">
                0.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">Theoretical Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography/index.html">References</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Modules API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="All_nmers.html">All nmers</a></li>
<li class="toctree-l2"><a class="reference internal" href="Atomic_Capping.html">Atomic Capping</a></li>
<li class="toctree-l2"><a class="reference internal" href="Atomic_Capping.html#single-atom-capper">Single Atom Capper</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bond-Based_Fragmenter.html">Bond-Based Fragmenter</a></li>
<li class="toctree-l2"><a class="reference internal" href="Broken_Bonds.html">Broken Bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="Cluster_Partition.html">Cluster Partition</a></li>
<li class="toctree-l2"><a class="reference internal" href="Covalent_Radius.html">Covalent Radius</a></li>
<li class="toctree-l2"><a class="reference internal" href="DCLC_Capping.html">DCLC Capping</a></li>
<li class="toctree-l2"><a class="reference internal" href="DCLC_Capping.html#dclc-capper">DCLC Capper</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fragment_Based_Method.html">Fragment Based Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fragment_Driver.html">Fragment Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="FragmentedChemicalSystem_Driver.html">FragmentedChemicalSystem Driver</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">GMBE Weights</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gmbe-fragment-weights">GMBE Fragment Weights</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#please-cite">Please Cite</a></li>
<li class="toctree-l4"><a class="reference internal" href="#property-types">Property Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-inputs">Module Inputs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fragments">Fragments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-results">Module Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Heavy_Atom_Partition.html">Heavy Atom Partition</a></li>
<li class="toctree-l2"><a class="reference internal" href="Intersections.html">Intersections</a></li>
<li class="toctree-l2"><a class="reference internal" href="Nuclear_Graph.html">Nuclear Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="Weighted_Distance.html">Weighted Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="Weighted_Distance.html#weighted-distance-capper">Weighted Distance Capper</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://rmrresearch.github.io/GhostFragment/cxx_api/index.html">C++ API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GhostFragment</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Modules API</a></li>
      <li class="breadcrumb-item active">GMBE Weights</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/rmrresearch/ghostfragment/edit/master/docs/source/module_api/GMBE_Weights.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gmbe-weights">
<h1>GMBE Weights<a class="headerlink" href="#gmbe-weights" title="Link to this heading"></a></h1>
<section id="gmbe-fragment-weights">
<h2>GMBE Fragment Weights<a class="headerlink" href="#gmbe-fragment-weights" title="Link to this heading"></a></h2>
<p>Given the list of subsystems (subsystem being defined as either a fragment or an
intersection) this module will determine the weights of each subsystem. This
module will NOT add intersections to the input list.</p>
<p>This module adopts the algorithm from DOI:10.1021/jp103074f. More specifically,
each subsystem with <span class="math notranslate nohighlight">\(\eta\)</span> nuclei in it represents an <span class="math notranslate nohighlight">\(eta\)</span>-body
interaction. Each <span class="math notranslate nohighlight">\(\eta\)</span>-body interaction should only occur once when we
sum up the subsystems. Therefore the coefficient of the <span class="math notranslate nohighlight">\(i\)</span>-th subsystem
is <span class="math notranslate nohighlight">\(c_i = 1-\sum_{j\supset i}c_j\)</span> where the sum is over the weights of
the proper supersets of the <span class="math notranslate nohighlight">\(i\)</span>-th subsystem.</p>
<p>While the non-linear nature of the weights may seem troubling at first, we can
exploit the fact that a proper superset must have more members. More
specifically, if we start with the supersystem(s) with the most members we know
they have weights of 1 because they can’t be subsets of any other subsystem. We
can then move on to the next largest subsystem(s) which can only be subsets of
the largest subsystem(s). The process then continues with the next largest
subsystem(s), so on and so forth. More formally:</p>
<ol class="arabic">
<li><p>Sort subsystems by length (remembering their original offset)</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(\eta\)</span> be the length of the largest subsystem(s)</p></li>
<li><p>Set <span class="math notranslate nohighlight">\(n\)</span> to <span class="math notranslate nohighlight">\(\eta\)</span></p></li>
<li><p>Let <span class="math notranslate nohighlight">\(c^n_i\)</span> be the weight for the <span class="math notranslate nohighlight">\(i\)</span>-th subsystem of length
<span class="math notranslate nohighlight">\(n\)</span>; set :math:c^n_i: to 1.0.</p></li>
<li><p>Loop over subsystem lengths <span class="math notranslate nohighlight">\(m\)</span> such that <span class="math notranslate nohighlight">\(m&gt;n\)</span>.</p>
<ol class="arabic">
<li><p>Loop over subsystems of length <span class="math notranslate nohighlight">\(m\)</span>, if the <span class="math notranslate nohighlight">\(j\)</span>-th subsystem of
length <span class="math notranslate nohighlight">\(m\)</span> is a supersystem of the <span class="math notranslate nohighlight">\(i\)</span>-th subsystem of length</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(n\)</span> subtract <span class="math notranslate nohighlight">\(c^m_j\)</span> from <span class="math notranslate nohighlight">\(c^n_i\)</span></p>
</div></blockquote>
</li>
</ol>
</li>
<li><p>Set <span class="math notranslate nohighlight">\(n\)</span> to <span class="math notranslate nohighlight">\(n-1\)</span>. If <span class="math notranslate nohighlight">\(n\)</span> is 0 terminate, otherwise return
to step 4.</p></li>
</ol>
<section id="please-cite">
<h3>Please Cite<a class="headerlink" href="#please-cite" title="Link to this heading"></a></h3>
<p>No citations</p>
</section>
<section id="property-types">
<h3>Property Types<a class="headerlink" href="#property-types" title="Link to this heading"></a></h3>
<p>The following is a list of property types that this module satisfies.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ghostfragment::pt::FragmentWeights</span></code></p></li>
</ul>
</section>
<section id="module-inputs">
<h3>Module Inputs<a class="headerlink" href="#module-inputs" title="Link to this heading"></a></h3>
<p>This section details the full list of inputs that the module accepts. Inputs
that are not listed as optional must have their value set before the module can
be run. Inputs can be set manually by calling the module’s <code class="docutils literal notranslate"><span class="pre">change_input</span></code>
function or by passing arguments to a property type.</p>
<section id="quick-reference">
<h4>Quick Reference<a class="headerlink" href="#quick-reference" title="Link to this heading"></a></h4>
<p>The following table provides a quick summary of the inputs available to this
module. The columns are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Key</span></code>: The key used to retrieve the option,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Default</span></code> : The initial value, if one exists, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Description</span></code> : A human readable description of what the option is used for.</p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Fragments</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table>
</section>
<section id="detailed-descriptions">
<h4>Detailed Descriptions<a class="headerlink" href="#detailed-descriptions" title="Link to this heading"></a></h4>
<p>The following subsections provide detailed descriptions of each input recognized
by this module. The subsection headings are the name of the input. Within each
subsection we list:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Description</span></code> : A human readable description of what the option is used for.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Default</span> <span class="pre">Value</span></code> : The initial value, if one exists.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Optional?</span></code> : Whether the value must be set inorder for the module to run.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Opaque?</span></code> : Does the value of the input influence memoization?.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Domain</span> <span class="pre">Restrictions</span></code> : Criteria a value must obey to be deemed valid.</p></li>
</ul>
</section>
</section>
</section>
<section id="fragments">
<h2>Fragments<a class="headerlink" href="#fragments" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Description : N/A</p></li>
<li><p>Default Value : N/A</p></li>
<li><p>Optional? : False</p></li>
<li><p>Opaque? : True</p></li>
<li><p>Domain Restrictions :</p>
<ul>
<li><p>Type == chemist::fragmenting::FragmentedChemicalSystem&lt;chemist::ChemicalSystem&gt;</p></li>
</ul>
</li>
</ul>
<section id="module-results">
<h3>Module Results<a class="headerlink" href="#module-results" title="Link to this heading"></a></h3>
<p>This section tabulates the full list of results that the module returns. The
columns respectively are:</p>
<ul class="simple">
<li><p>Key: What the result is called</p></li>
<li><p>Type: The C++ type of the result</p></li>
<li><p>Description: What the result is/how it was computed.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A given property type will only return a subset of the available results.
Additional results can be accessed by using other property types or by using
the Module class’s advanced API.</p>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Weights</p></td>
<td><p>std::vector&lt;double, std::allocator&lt;double&gt;&gt;</p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table>
</section>
<section id="submodules">
<h3>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h3>
<p>The module defines no submodules.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="FragmentedChemicalSystem_Driver.html" class="btn btn-neutral float-left" title="FragmentedChemicalSystem Driver" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Heavy_Atom_Partition.html" class="btn btn-neutral float-right" title="Heavy Atom Partition" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Ryan M Richard.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
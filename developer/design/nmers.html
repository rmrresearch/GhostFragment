<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Designing the NMer Driver &mdash; GhostFragment 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=d45e8c67"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="GMBE Coefficients" href="gmbe_coefficients.html" />
    <link rel="prev" title="Designing GhostFragment’s FragmentedNuclei Driver" href="fragmented_nuclei_driver.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            GhostFragment
          </a>
              <div class="version">
                0.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../background/index.html">Theoretical Background</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Designing GhostFragment</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="overview.html">GhostFragment Design Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="input_driver.html">Designing GhostFragment’s Input Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="fragmented_system_driver.html">Designing GhostFragment’s FragmentedSystem Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="fragmented_molecule_driver.html">Designing the FragmentedMolecule Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="fragmented_nuclei_driver.html">Designing GhostFragment’s FragmentedNuclei Driver</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Designing the NMer Driver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-is-an-n-mer">What is an <span class="math notranslate nohighlight">\(n\)</span>-mer?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#why-do-we-need-n-mers">Why do we need <span class="math notranslate nohighlight">\(n\)</span>-mers?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nmerdriver-considerations">NMerDriver Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nmerdriver-design">NMerDriver Design</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="gmbe_coefficients.html">GMBE Coefficients</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development/index.html">GhostFragment Development Topics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../bibliography/index.html">References</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rmrresearch.github.io/GhostFragment/cxx_api/index.html">C++ API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GhostFragment</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Developer Documentation</a></li>
          <li class="breadcrumb-item"><a href="index.html">Designing GhostFragment</a></li>
      <li class="breadcrumb-item active">Designing the NMer Driver</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/rmrresearch/ghostfragment/edit/master/docs/source/developer/design/nmers.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="designing-the-nmer-driver">
<span id="gf-nmer-driver-design"></span><h1>Designing the NMer Driver<a class="headerlink" href="#designing-the-nmer-driver" title="Link to this heading"></a></h1>
<section id="what-is-an-n-mer">
<h2>What is an <span class="math notranslate nohighlight">\(n\)</span>-mer?<a class="headerlink" href="#what-is-an-n-mer" title="Link to this heading"></a></h2>
<p>If we think of each fragment as a set of atoms, then an <span class="math notranslate nohighlight">\(n\)</span>-mer, simply put
is the set of atoms which results from taking the union of <span class="math notranslate nohighlight">\(n\)</span> fragments. The
driver is responsible for wrapping the process of going from an input
<code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> to the final set of <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code>.</p>
</section>
<section id="why-do-we-need-n-mers">
<h2>Why do we need <span class="math notranslate nohighlight">\(n\)</span>-mers?<a class="headerlink" href="#why-do-we-need-n-mers" title="Link to this heading"></a></h2>
<p>Fragments usually consist of spatially local atoms. Simply summing the energies
of the fragments would neglect the many-body interactions and would be a poor
approximation. To better approximate the energy we need to account for the
significant many-body interactions. One way to do this is through the so-called
supermolecular method, namely to compute the <span class="math notranslate nohighlight">\(n\)</span>-body interaction of <span class="math notranslate nohighlight">\(n\)</span>
fragments one takes the union of the <span class="math notranslate nohighlight">\(n\)</span> fragments, computes the energy, and
then subtracts out the energies of the fragments, the two-body interactions,
the three-body interactions, …, and the <span class="math notranslate nohighlight">\((n-1)\)</span>-body interactions.
Thus we need <span class="math notranslate nohighlight">\(n\)</span>-mers to compute <span class="math notranslate nohighlight">\(n\)</span>-body interactions via the supermolecular
method.</p>
</section>
<section id="nmerdriver-considerations">
<h2>NMerDriver Considerations<a class="headerlink" href="#nmerdriver-considerations" title="Link to this heading"></a></h2>
<dl class="simple" id="nd-frags">
<dt>Fragments.</dt><dd><p>The entire concept of an <span class="math notranslate nohighlight">\(n\)</span>-mer is predicated on the existence of the
fragments. Depending on the application of the <span class="math notranslate nohighlight">\(n\)</span>-mers, we may need to
record which fragments formed the <span class="math notranslate nohighlight">\(n\)</span>-mer.</p>
</dd>
</dl>
<dl class="simple" id="nd-screening">
<dt>Screening.</dt><dd><p>If we always wanted to iterate over the entire set of <span class="math notranslate nohighlight">\(n\)</span>-mers we could
use a generator (or something similar) to create the <span class="math notranslate nohighlight">\(n\)</span>-mers as needed,
<em>i.e.</em>, there would be no need to store the fragments. In practice, the
reason we need the NMers class is because we only want to store the
<span class="math notranslate nohighlight">\(n\)</span>-mers which passed screening. Screening based on energy (or distance)
requires us to have capped <span class="math notranslate nohighlight">\(n\)</span>-mers.</p>
</dd>
</dl>
<dl class="simple" id="nd-output">
<dt>FragmentedNuclei output</dt><dd><p>While the fragments are screened as <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> objects, it is
actually the <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code> of the <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> objects which are combined
to form the <span class="math notranslate nohighlight">\(n\)</span>-mers, not the <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> objects. Thus the output should
be another <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> object.</p>
<ul class="simple">
<li><p>Trying to take unions of molecules also requires us to take unions of
the electrons too. In practice, the number of electrons in an <span class="math notranslate nohighlight">\(n\)</span>-mer is
also just dictated by the identity of the nuclei in the <span class="math notranslate nohighlight">\(n\)</span>-mer.</p></li>
<li><p>Assigning charges/multiplicity from the fragments is actually more
difficult than assinging them from the overall <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code>. In
the former one must determine how to combine the charges and multiplicities
of the fragments, whereas the latter amounts to assinging the charge,
unpaired electrons to atoms in the overall system.</p></li>
<li><p>It is also worth noting that if we tried to take unions of capped fragments
we would have to determine if the atom the cap is replacing also appears
in the fragment. This is just easier to do by reassigning caps after
establishing the <span class="math notranslate nohighlight">\(n\)</span>-mers.</p>
<ul>
<li><p>The set of caps needed for the <span class="math notranslate nohighlight">\(n\)</span>-mers is a subset of those needed
for the fragments.</p></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
<section id="nmerdriver-design">
<h2>NMerDriver Design<a class="headerlink" href="#nmerdriver-design" title="Link to this heading"></a></h2>
<figure class="align-center" id="id1">
<span id="fig-gf-nmer-driver"></span><img alt="../../_images/nmer_driver.png" src="../../_images/nmer_driver.png" />
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">The architecture of the nmer driver component.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fragmented_nuclei_driver.html" class="btn btn-neutral float-left" title="Designing GhostFragment’s FragmentedNuclei Driver" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gmbe_coefficients.html" class="btn btn-neutral float-right" title="GMBE Coefficients" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Ryan M Richard.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>